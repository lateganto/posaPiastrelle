;----------------------------MASSETTO---------------------------------

(defrule no_impianti_fatti
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))
	
	(car (nome presenza_massetto) (valore no))
	(car (nome impianti_fatti) (valore no))
	=>
	(bind ?*soluzione* "Devi vedere prima se passeranno degli impianti (acqua, fognatura, elettricità, etc.) sotto il massetto.")
	(assert (lavoro)))

(defrule si_impianti_fatti
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))
	
	(car (nome presenza_massetto) (valore no))
	(car (nome impianti_fatti) (valore si))
	=>
	(bind ?*soluzione* "Procedi alla realizzazione del massetto")
	(assert (lavoro)))

(defrule massetto_fresco
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore si))
	=>
	(bind ?*soluzione* "Il massetto deve prima asciugare, non si può continuare con il lavoro.")
	(assert (lavoro)))

(defrule massetto_fragile
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore si))
	=>
	(bind ?*soluzione* "Il massetto è fragile, occorre rimuoverlo e rifarlo.")
	(assert (lavoro)))

(defrule massetto_non_a_livello
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore interno))
	(car (nome massetto_a_livello) (valore no))
	=>
	(bind ?*soluzione* "Il massetto deve essere rimosso e rifatto poiché non a livello.")
	(assert (lavoro)))

(defrule no_spessore_piastrella
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore interno))
	(car (nome massetto_a_livello) (valore si))
	(car (nome pavimento_da_raccordare) (valore si))
	(car (nome spessore_pavimento) (valore no))
	=>
	(bind ?*soluzione* "Se non si conosce lo spessore della piastrella non si può cominciare la posa del pavimento poiché non si sa a che altezza realizzare il massetto.")
	(assert (lavoro)))

(defrule massetto_alto
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))
	
	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore interno))
	(car (nome massetto_a_livello) (valore si))
	(car (nome pavimento_da_raccordare) (valore si))
	(car (nome altezza_massetto) (valore alto))
	=>
	(bind ?*soluzione* "Il massetto è troppo alto per la posa del pavimento selezionato, rimuoverlo e rifarlo in modo che sia alla giusta altezza.")
	(assert (lavoro)))

(defrule massetto_basso
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore interno))
	(car (nome massetto_a_livello) (valore si))
	(car (nome pavimento_da_raccordare) (valore si))
	(car (nome altezza_massetto) (valore basso))
	=>
	(bind ?*soluzione* "Il massetto è troppo basso per la posa del pavimento selezionato, rimuoverlo e rifarlo in modo che sia alla giusta altezza.")
	(assert (lavoro)))

(defrule massetto_senza_pendenza
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore esterno))
	(car (nome pendenza_massetto) (valore no))
	=>
	(bind ?*soluzione* "Il massetto non ha la giusta pendenza per lo scolo dell'acqua, rimuoverlo e rifarlo.")
	(assert (lavoro)))

(defrule muri_non_a_squadra_esterno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore esterno))
	(car (nome pendenza_massetto) (valore si))
	(car (nome muri_a_squadra) (valore no))
	=>
	(bind ?*soluzione* "I muri non sono a squadra, conviene usare un tipo di posa in diagonale e una piastrella piccola in modo da camuffare le imperfezioni. Inoltre parti dal punto più a vista nella stanza, in genere il lato opposto all'entrata.")
	(assert (lavoro)))

(defrule muri_non_a_squadra_interno_piastrella
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome massetto_a_livello) (valore si))
	(car (nome luogo) (valore interno))
	(or (car (nome pavimento_da_raccordare) (valore no))
		(car (nome altezza_massetto) (valore giusto)))
	(car (nome muri_a_squadra) (valore no))
	(car (nome tipo_pavimento_da_porre) (valore piastrella))
	=>
	(bind ?*soluzione* "I muri non sono a squadra, conviene usare un tipo di posa in diagonale e una piastrella piccola in modo da camuffare le imperfezioni. Inoltre parti dal punto più a vista nella stanza, in genere il lato opposto all'entrata.")
	(assert (lavoro)))

(defrule muri_non_a_squadra_piastrella_interno_parquet
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome massetto_a_livello) (valore si))
	(car (nome luogo) (valore interno))
	(or (car (nome pavimento_da_raccordare) (valore no))
		(car (nome altezza_massetto) (valore giusto)))
	(car (nome muri_a_squadra) (valore no))
	(car (nome tipo_pavimento_da_porre) (valore parquet))
	=>
	(bind ?*soluzione* "Comincia con la posa del pavimento.")
	(assert (lavoro)))

(defrule muri_a_squadra_interno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome massetto_a_livello) (valore si))
	(car (nome luogo) (valore interno))
	(or (car (nome pavimento_da_raccordare) (valore no))
		(car (nome altezza_massetto) (valore giusto)))
	(car (nome muri_a_squadra) (valore si))
	=>
	(bind ?*soluzione* "Comincia con la posa del pavimento.")
	(assert (lavoro)))

(defrule muri_a_squadra_esterno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_massetto) (valore si))
	(car (nome massetto_fresco) (valore no))
	(car (nome massetto_fragile) (valore no))
	(car (nome luogo) (valore esterno))
	(car (nome pendenza_massetto) (valore si))
	(car (nome muri_a_squadra) (valore si))
	=>
	(bind ?*soluzione* "Comincia con la posa del pavimento.")
	(assert (lavoro)))


;--------------------PAVIMENTO-----------------------

(defrule pavimento_non_a_livello_interno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(car (nome presenza_pavimento) (valore si))
	(car (nome pavimento_livello) (valore no))
	=>
	(bind ?*soluzione* "Rimuovi il pavimento esistente e lo strato di fondo sottostante e rifallo.")
	(assert (lavoro)))

(defrule pavimento_senza_pendenza_esterno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore esterno))
	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(car (nome pendenza_pavimento) (valore no))
	=>
	(bind ?*soluzione* "Rimuovi il pavimento esistente e lo strato di fondo sottostante e rifallo.")
	(assert (lavoro)))

(defrule piastrelle_sollevate
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(or (car (nome luogo) (valore interno))
		(car (nome luogo) (valore esterno)))
	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(car (nome piastrelle_sollevate_pavimento) (valore si))
	=>
	(bind ?*soluzione* "Rimuovi il pavimento esistente e lo strato di fondo sottostante e rifallo.")
	(assert (lavoro)))

(defrule piastrelle_scheggiate_o_rotte_poche
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(or (car (nome luogo) (valore interno))
		(car (nome luogo) (valore esterno)))
	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(car (nome piastrelle_scheggiate_rotte_pavimento) (valore poche))
	=>
	(bind ?*soluzione* "Puoi optare per la sostituzione a patto che tu abbia qualche piastrella disponibile.")
	(assert (lavoro)))

(defrule piastrelle_scheggiate_o_rotte_molte
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(or (car (nome luogo) (valore interno))
		(car (nome luogo) (valore esterno)))
	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(car (nome piastrelle_scheggiate_rotte_pavimento) (valore molte))
	=>
	(bind ?*soluzione* "Sostituisci il pavimento poiché le piastrelle rovinate sono troppe.")
	(assert (lavoro)))

(defrule umidita_impianti
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(car (nome presenza_pavimento) (valore si))
	(car (nome umidita_pavimento) (valore si))
	(car (nome impianti_umidita) (valore si))
	=>
	(bind ?*soluzione* "L'umidità potrebbe essere causata da impianti idrici guasti, rimuovi il massetto e il pavimento e chiama uno specialista (idraulico).")
	(assert (lavoro)))

(defrule umidita_piano_terra
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_pavimento) (valore si))
	(car (nome umidita_pavimento) (valore si))
	(car (nome impianti_umidita) (valore no))
	(car (nome piano_terra) (valore si))
	=>
	(bind ?*soluzione* "L'umidità potrebbe essere causata dal sottosuolo, occorre rimuovere il pavimento e il massetto (se presenti) e procedere alla impermeabilizzazione del nuovo pavimento che deve essere fatto.")
	(assert (lavoro)))

(defrule umidita_no_piano_terra
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_pavimento) (valore si))
	(car (nome umidita_pavimento) (valore si))
	(car (nome impianti_umidita) (valore no))
	(car (nome piano_terra) (valore no))
	=>
	(bind ?*soluzione* "L'umidità potrebbe essere quella di risalita dai muri, bisogna impermeabilizzare il muro in modo da non far salire l'umidità.")
	(assert (lavoro)))

(defrule rumore_calpestio
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(or (car (nome luogo) (valore interno))
		(car (nome luogo) (valore esterno)))
	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(car (nome rumore_al_calpestio) (valore si))
	=>
	(bind ?*soluzione* "Il pavimento è stato posto senza un opportuno spazio di assestamento lungo il perimetro dei muri, per risolverlo occorre rimuovere il pavimento.")
	(assert (lavoro)))

(defrule fughe_polvere
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(car (nome polvere_sulle_fughe) (valore si))
	=>
	(bind ?*soluzione* "Usa un impermeabilizzante per ricoprire le fughe.")
	(assert (lavoro)))

(defrule posa_sopra_si_piastrelle
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(or (car (nome luogo) (valore interno))
		(car (nome luogo) (valore esterno)))
	(car (nome presenza_pavimento) (valore si))
	(or (car (nome tipo_pavimento_presente) (valore piastrelle))
		(car (nome tipo_pavimento_presente) (valore marmo)))
	(or (car (nome pavimento_livello) (valore si))
		(car (nome pendenza_pavimento) (valore si)))
	(car (nome piastrelle_sollevate_pavimento) (valore no))
	(car (nome umidita_pavimento) (valore no))
	=>
	(bind ?*soluzione* "Puoi optare per la posa sopra usando anche pavimenti ultra sottili come il gres o il multistrato adesivo.")
	(assert (lavoro)))

;-------------------------RIVESTIMENTO----------------------------
(defrule muri_non_a_piombo
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(or (car (nome tipo_stanza) (valore bagno))
		(car (nome tipo_stanza) (valore cucina)))
	(car (nome presenza_rivestimento) (valore no))
	(car (nome muri_a_piombo) (valore no))
	=>
	(bind ?*soluzione* "Aggiustare i muri per garantire una buona posa.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule fondo_gesso_rasato_bagno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(car (nome tipo_stanza) (valore bagno))
	(car (nome presenza_rivestimento) (valore no))
	(car (nome muri_a_piombo) (valore si))
	(car (nome sottofondo_muri) (valore gesso_rasato))
	=>
	(bind ?*soluzione* "Devi passare prima una mano di idropittura, farla asciugare e poi iniziare con la posa.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule fondo_gesso_rasato_cucina
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(car (nome tipo_stanza) (valore cucina))
	(car (nome presenza_rivestimento) (valore no))
	(car (nome muri_a_piombo) (valore si))
	(car (nome sottofondo_muri) (valore gesso_rasato))
	=>
	(bind ?*soluzione* "Devi passare prima una mano di idropittura, farla asciugare e poi iniziare con la posa. Considera che si può anche effettuare la posa delle piastrelle nella fascia dietro la cucina.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule fondo_ok_cucina
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(car (nome tipo_stanza) (valore cucina))
	(car (nome presenza_rivestimento) (valore no))
	(car (nome muri_a_piombo) (valore si))
	(or (car (nome sottofondo_muri) (valore muro_pitturato))
		(car (nome sottofondo_muri) (valore sabbia_e_cemento)))
	=>
	(bind ?*soluzione* "Puoi iniziare la posa ricordando che puoi anche posare le piastrelle nella fascia dietro la cucina invece di posarle per tutto il muro.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule fondo_ok_bagno
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(car (nome tipo_stanza) (valore bagno))
	(car (nome presenza_rivestimento) (valore no))
	(car (nome muri_a_piombo) (valore si))
	(or (car (nome sottofondo_muri) (valore muro_pitturato))
		(car (nome sottofondo_muri) (valore sabbia_e_cemento)))
	=>
	(bind ?*soluzione* "Puoi iniziare la posa.")
	(assert (lavoro)))

(defrule piastrelle_sollevate_rivestimento
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(or (car (nome tipo_stanza) (valore bagno))
		(car (nome tipo_stanza) (valore cucina)))
	(car (nome presenza_rivestimento) (valore si))
	(car (nome piastrelle_sollevate_rivestimento) (valore si))
	=>
	(bind ?*soluzione* "Rimuovi il rivestimento esistente e rifallo.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule piastrelle_scheggiate_rivestimento_poche
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(or (car (nome tipo_stanza) (valore bagno))
		(car (nome tipo_stanza) (valore cucina)))
	(car (nome presenza_rivestimento) (valore si))
	(car (nome piastrelle_scheggiate_rivestimento) (valore poche))
	=>
	(bind ?*soluzione* "Puoi sostituire le piastrelle scheggiate con delle nuove se le possiedi (fai attenzione alla diversa tonalità che potrebbe esserci tra le piastrelle vecchie e quella nuova con cui fare il rattoppo). Altrimenti sostituisci tutto il rivestimento.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule piastrelle_scheggiate_rivestimento_molte
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(or (car (nome tipo_stanza) (valore bagno))
		(car (nome tipo_stanza) (valore cucina)))
	(car (nome presenza_rivestimento) (valore si))
	(car (nome piastrelle_scheggiate_rivestimento) (valore molte))
	=>
	(bind ?*soluzione* "Sostituisci tutto il rivestimento.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))

(defrule rivestimento_buone_condizioni
	(declare (salience ?*high_priority*))
	(preparazione_utente alta | bassa)
	(not (lavoro))

	(car (nome luogo) (valore interno))
	(or (car (nome tipo_stanza) (valore bagno))
		(car (nome tipo_stanza) (valore cucina)))
	(car (nome presenza_rivestimento) (valore si))
	(car (nome piastrelle_scheggiate_rivestimento) (valore no))
	(car (nome piastrelle_sollevate_rivestimento) (valore no))
	=>
	(bind ?*soluzione* "Il pavimento è in buone condizioni potresti anche rinnovarlo usando gli adesivi in pvc.")
	(assert (lavoro))
	(assert (rivestimento_parte_due)))


;- si possono usare pavimenti adesivi (multistrato adesivo) o resina o gres ultrasottile in modo da non modificare gli infissi e le porte
;- Se c'è umidità perenne meglio pavimento con fughe adeguate

;Chiedi a cosa è adibito il locale?

;Spessore fughe

;Piastrelle alzate o scheggiate [cause: mancanza di giunto di dilatazione ogni 25 mquadri, umidità, tubature idriche con perdite, collante non posto bene]

;		Usa pavimenti adesivi o resina [perchè evita di dover fare modifiche alle porte, economici, posa su pavimento esistente]

;	ALTRIMENTI rifai pavimento





